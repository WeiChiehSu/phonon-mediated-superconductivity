得到響應電荷密度和響應擾動勢後,便能透過Hellman-Feynman Theory得到系統所受的力. Hellman-Feynman Theory描述能量對參數的導數和勢能(對參數的導數)的期望值間的關係:

After obtaining the induced charge density and the induced perturbation potential, the force acting on the system can be determined using the Hellmann–Feynman theorem. The Hellmann–Feynman theorem describes the relationship between the derivative of the energy with respect to a parameter and the expectation value of the derivative of the potential (with respect to that parameter):

$$
\frac{\partial \varepsilon_{electron} }{\partial R_{k:direction,\gamma:atom }(r) }=\int n_{0}\frac{\partial V_{SCF} }{\partial R_{k:direction,\gamma:atom }(r)}dr\Longrightarrow \Delta \varepsilon_{electron}(r)=\int n_{0}\Delta V_{SCF}(r)dr  
$$

以簡單的功能定理W=F.r來解釋,便是F外加了一個小力,導致作功位移r產生了小位移,那計算出這個小力和小位移對系統總作功的產生的變化,便是Hellman-Feynman Theory的目的;小力和小位移可以簡單當成響應擾動勢和響應電荷密度.

This can be explained using the simple work relation W=F⋅r: when a small external force F is applied, it produces a small displacement r, resulting in a change in the work done on the system. Calculating how this small force and small displacement modify the total work of the system is the purpose of the Hellmann–Feynman theorem. The small force and small displacement can be regarded, respectively, as the induced perturbation potential and the induced charge density.

將公式展開後,能量對參數的導數可以寫成下面的形式:

Expanding the expression, the derivative of the energy with respect to the parameter can be written in the following form:

$$
\varepsilon _{R} =\varepsilon _{0}+\sum_{k\gamma }^{}  R_{k\gamma} (r)\int n_{0} (r)\frac{\partial V_{SCF}(r) }{\partial R_{k\gamma} (r)}dr+\frac{1}{2}\sum_{R_{k,k'\gamma} }^{} R_{k\gamma} (r)R_{k'\gamma} (r) \int [\frac{\partial n(r)}{\partial R_{k'\gamma} (r)}\frac{\partial V_{SCF}(r) }{\partial R_{k\gamma} (r)}+n_{0}(r) \frac{\partial^2 V_{SCF}(r) }{\partial R_{k\gamma} (r)\partial R_{k'\gamma} (r)}]dr
$$

$$
其中的勢能對參數的導數和電荷密度對參數的導數為DFPT計算出來的響應擾動勢\Delta V_{SCF}(r)和響應電荷密度\Delta n(r):
$$

$$
Here,{}the{}derivative{}of{}the{}potential{}with{}respect{}to{}the{}parameter{}and{}the{}derivative{}of{}the{}charge{}density{}with{}respect{}to{}the{}parameter{}correspond{}to{}the{}induced{}perturbation{}potential{}\Delta{}V_{SCF}(r){}and{}the{}induced{}charge{}density{}\Delta{}n(r){}computed{}by{}DFPT:
$$

$$
\frac{\partial V_{SCF}(r) }{\partial R_{k\gamma} (r)}=\Delta V_{SCF}(r);\frac{\partial n(r)}{\partial R_{k'\gamma} (r)}=\Delta n(r)\
$$

$$
定義系統的力常數為 C_{k\gamma ,k'\gamma '} (r_{\gamma}-r_{\gamma'})為能量的二階導數,其中分為離子貢獻項和電子貢獻項:
$$

$$
Define:C_{k\gamma ,k'\gamma '} (r_{\gamma}-r_{\gamma'})= \frac{\partial^2 \varepsilon }{\partial R_{k\gamma }(r_{\gamma })  \partial R_{k'\gamma' }(r_{\gamma' })} = C_{k\gamma ,k'\gamma '}^{ion}(r_{\gamma}-r_{\gamma'})+C_{k\gamma ,k'\gamma '}^{electron}(r_{\gamma}-r_{\gamma'})
$$

則公式可以變換為下面的形式:

$$
\varepsilon _{R} =\varepsilon _{0}+\sum_{k\gamma }^{}  R_{k\gamma} (r)C_{k\gamma ,k'\gamma '}^{ion}(r_{\gamma}-r_{\gamma'})+\frac{1}{2}\sum_{R_{k,k'\gamma} }^{} R_{k\gamma} (r)R_{k'\gamma} (r) C_{k\gamma ,k'\gamma '}^{electron}(r_{\gamma}-r_{\gamma'})
$$

$$
\begin{cases}
C_{k\gamma, k'\gamma'}^{\text{ion}}(r_\gamma - r_{\gamma'}) 
= n_0(r) \frac{\partial V_{\text{SCF}}(r)}{\partial R_{k\gamma}(r)}, \\
C_{k\gamma, k'\gamma'}^{\text{electron}}(r_\gamma - r_{\gamma'}) 
= \frac{\partial n(r)}{\partial R_{k'\gamma}(r)} \frac{\partial V_{\text{SCF}}}{\partial R_{k\gamma}(r)}+n_0(r) \frac{\partial^2 V_{\text{SCF}}}{\partial R_{k\gamma}(r) \, \partial R_{k'\gamma}(r)}
\end{cases}
$$

$$
\Longrightarrow C_{k\gamma ,k'\gamma '}(r_{\gamma }- r_{\gamma' } )\propto n_{0}(r),\Delta V_{SCF}(r)and\Delta n(r)
$$

得到系統的力常數後,將其變換至動量空間,可求得動力學矩陣:

$$
C_{k\gamma,k'\gamma'}(r_{\gamma}-r_{\gamma'})=\frac{1}{N}\sum_{q}^{} e^{iq(r_{\gamma}-r_{\gamma'})}C_{k\gamma,k'\gamma'}(q)  \Longrightarrow D_{k\gamma,k'\gamma'}(q)=\frac{C_{k\gamma,k'\gamma'}(q) }{\sqrt{m_{\gamma}m_{\gamma'}  } }
$$

擁有動力學矩陣後,便能計算出系統的聲子頻率.

$$
\sum_{k',\gamma'}^{} D_{k,\gamma;k',\gamma'}(q)u_{k',\gamma'}(q)=\omega _{q}^{2} u_{k',\gamma'}(q)
$$

